/* 
Модуль содержит функции selectors

*/

import R from 'ramda'

// Поиск по ID, возвращает объект по ID или null
export const getPhoneById = (state, id) => R.prop(id, state.phones)

export const getPhones = state => {
    // Мапим  ids, чтобы найти все нужные телефоны
    const phones = R.map(id => getPhoneById(state, id), state.phonesPage.ids)
    return phones

}
// Показывает товары уже отрисованые на старнице
// R.length возвращает длину массива
export const getRenderedPhonesLength = state => R.length(state.phonesPage.ids)


// Методы корзины

// Подсчет колличества товаров в корзине
export const getTotalBasketCount = state => R.length(state.basket)

// Подсчет общей цены товаров в корзине, просто считаем длинну массива корзины
export const getTotalBasketPrice = state => {
    // Compose работает справа на лево, берем из корзины все телефоны по idшникам.
    // Берем из каждого обьекта только цену и потом суммируем ее с помощью метода sum.
    const totalPrice = R.compose(
      R.sum,
      R.pluck('price'),
      R.map(id => getPhoneById(state, id)) // Используем ранее созданный метод getPhoneById
    )(state.basket)
  
    return totalPrice
  }